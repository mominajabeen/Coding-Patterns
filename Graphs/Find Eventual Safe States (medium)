#include <iostream>
#include <vector>
#include <algorithm>

using namespace std;

class Solution {
public:
    vector<int> eventualSafeNodes(vector<vector<int>>& graph) {
        int n = graph.size();
        vector<int> visited(n, 0);
        vector<int> result;
        for(int i = 0; i < n; i++){
            if(dfs(graph, visited, i))
                result.push_back(i);
        }
        sort(result.begin(), result.end());
        return result;
    }
private:
    bool dfs(vector<vector<int>>& graph, vector<int> &visited, int node){
        if(visited[node] == -1) return true;
        if(visited[node] == 1)  return false;

        visited[node] = 1;
        for(int next : graph[node]){
            if(!dfs(graph, visited, next))
                return false;
        }
        visited[node] = -1;
        return true;
    }
};
