#include <iostream>
#include <queue>
using namespace std;

struct Pair{
    TreeNode* node;
    int index;
    Pair(TreeNode* node, int index) : node(node), index(index){}
};

// struct TreeNode {
//     int val;
//     TreeNode* left;
//     TreeNode* right;
//     TreeNode(int x) : val(x), left(NULL), right(NULL) {}
// };

class Solution {
public:
    // Method to find the maximum width of the binary tree
    int widthOfBinaryTree(TreeNode* root) {
        if(!root)   return 0;
        queue<Pair> q;
        q.push(Pair(root, 0));
        int maxWidth = 0;


        while(!q.empty()){
            int size = q.size();
            int minIndex = q.front().index;
            int first = 0, last = 0;

            for(int i = 0; i < size; i++){
                Pair current = q.front();
                q.pop();
                TreeNode* node = current.node;
                int index = current.index - minIndex;
                if(i == 0)  first = index;
                if(i == size - 1)   last = index;

                if(node->left){
                    q.push(Pair(node->left, 2 * index));
                }
                if(node->right){
                    q.push(Pair(node->right, 2 * index + 1));
                }
            }
            maxWidth = max(maxWidth, last - first + 1);
        }
    return maxWidth;
    }
};
